import{a as E}from"./chunk-JMK7WGOY.js";import{a as P}from"./chunk-BCTV2CAY.js";import{e as I,i as O}from"./chunk-35LWYR67.js";import{Ha as m,Hb as y,Ib as S,Jb as w,Na as v,Pa as c,Ra as b,Sb as A,Va as n,Wa as i,Ya as C,Z as x,Za as h,_a as l,db as s,eb as p,fa as _,ga as f,gb as k,ib as M,xa as o,ya as u}from"./chunk-USG2AWOP.js";function T(r,g){r&1&&(n(0,"div",12),s(1,"Loading messages..."),i())}function F(r,g){r&1&&(n(0,"div",12),s(1," No contact messages yet. "),i())}function D(r,g){if(r&1){let t=C();n(0,"article",15)(1,"div",16)(2,"div")(3,"h3"),s(4),i(),n(5,"p",17),s(6),i()(),n(7,"span",18),s(8),i()(),n(9,"p",19),s(10),i(),n(11,"div",20)(12,"button",21),h("click",function(){let a=_(t).$implicit,d=l(2);return f(d.markRead(a))}),s(13," Mark Read "),i(),n(14,"button",22),h("click",function(){let a=_(t).$implicit,d=l(2);return f(d.deleteMessage(a))}),s(15," Delete "),i()()()}if(r&2){let t=g.$implicit,e=l(2);b("unread",!t.isRead),o(4),p(t.subject),o(2),k("",t.name," \u2022 ",t.email,""),o(2),p(e.formatDate(t.createdAt)),o(2),p(t.message),o(2),c("disabled",t.isRead||e.isMarking(t)||e.saving()),o(2),c("disabled",e.saving())}}function B(r,g){if(r&1&&(n(0,"div",13),v(1,D,16,9,"article",14),i()),r&2){let t=l();o(),c("ngForOf",t.messages())("ngForTrackBy",t.trackById)}}var Q=(()=>{class r{constructor(t,e){this.contactService=t,this.toast=e,this.messages=m([]),this.loading=m(!0),this.saving=m(!1),this.markingIds=m(new Set)}ngOnInit(){this.refresh()}markRead(t){let e=t.id;e!=null&&(this.addMarking(e),this.saving.set(!0),this.contactService.markRead(e).subscribe(a=>{this.saving.set(!1),this.removeMarking(e),a?(this.toast.show("Marked as read.","success"),this.refresh()):this.toast.show("Failed to mark as read.","error")}))}deleteMessage(t){let e=t.id;e!=null&&(this.saving.set(!0),this.contactService.delete(e).subscribe(a=>{this.saving.set(!1),a?(this.toast.show("Message deleted.","success"),this.refresh()):this.toast.show("Failed to delete message.","error")}))}refresh(){this.loading.set(!0),this.contactService.getAll().subscribe(t=>{let e=[...t].sort((a,d)=>{let R=a.createdAt?Date.parse(a.createdAt):0;return(d.createdAt?Date.parse(d.createdAt):0)-R});this.messages.set(e),this.loading.set(!1)})}formatDate(t){return t?new Date(t).toLocaleString():"\u2014"}trackById(t,e){return e.id}isMarking(t){let e=t.id;return e==null?!1:this.markingIds().has(e)}addMarking(t){let e=new Set(this.markingIds());e.add(t),this.markingIds.set(e)}removeMarking(t){let e=new Set(this.markingIds());e.delete(t),this.markingIds.set(e)}static{this.\u0275fac=function(e){return new(e||r)(u(E),u(A))}}static{this.\u0275cmp=x({type:r,selectors:[["app-contacts-admin"]],standalone:!0,features:[M],decls:22,vars:3,consts:[[1,"section","admin-contacts"],[1,"container"],["appReveal","",1,"admin-contacts__header"],["appReveal","",1,"admin-contacts__actions"],["routerLink","/admin/bio",1,"btn","btn--outline"],["routerLink","/admin/books",1,"btn","btn--outline"],["routerLink","/admin/projects",1,"btn","btn--outline"],["routerLink","/admin/pictures",1,"btn","btn--outline"],["routerLink","/",1,"btn","btn--outline"],["appReveal","",1,"admin-contacts__list"],["class","empty-state",4,"ngIf"],["class","messages-grid",4,"ngIf"],[1,"empty-state"],[1,"messages-grid"],["class","message-card glass-card",3,"unread",4,"ngFor","ngForOf","ngForTrackBy"],[1,"message-card","glass-card"],[1,"message-card__header"],[1,"message-card__meta"],[1,"message-card__date"],[1,"message-card__body"],[1,"message-card__actions"],[1,"btn","btn--sm","btn--outline",3,"click","disabled"],[1,"btn","btn--sm","btn--primary",3,"click","disabled"]],template:function(e,a){e&1&&(n(0,"section",0)(1,"div",1)(2,"div",2)(3,"h2"),s(4,"Admin Contacts"),i(),n(5,"p"),s(6,"Review, mark, and remove contact messages."),i()(),n(7,"div",3)(8,"a",4),s(9,"Back to Bio"),i(),n(10,"a",5),s(11,"Manage Books"),i(),n(12,"a",6),s(13,"Manage Projects"),i(),n(14,"a",7),s(15,"Manage Pictures"),i(),n(16,"a",8),s(17,"Back to Portfolio"),i()(),n(18,"div",9),v(19,T,2,0,"div",10)(20,F,2,0,"div",10)(21,B,2,2,"div",11),i()()()),e&2&&(o(19),c("ngIf",a.loading()),o(),c("ngIf",!a.loading()&&a.messages().length===0),o(),c("ngIf",!a.loading()&&a.messages().length))},dependencies:[w,y,S,O,I,P],styles:[".admin-contacts__header[_ngcontent-%COMP%]{text-align:center;margin-bottom:2rem}.admin-contacts__header[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{color:var(--text-primary);font-size:2rem;margin-bottom:.5rem}.admin-contacts__header[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{color:var(--text-secondary)}.admin-contacts__actions[_ngcontent-%COMP%]{display:flex;justify-content:center;gap:1rem;flex-wrap:wrap;margin-bottom:2rem}.messages-grid[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(auto-fit,minmax(280px,1fr));gap:1.5rem}.message-card[_ngcontent-%COMP%]{padding:1.5rem;display:flex;flex-direction:column;gap:1rem}.message-card.unread[_ngcontent-%COMP%]{border-color:#6c63ff59;box-shadow:0 0 20px #6c63ff26}.message-card__header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;gap:1rem}.message-card[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{color:var(--text-primary);margin:0 0 .25rem}.message-card__meta[_ngcontent-%COMP%]{color:var(--text-secondary);font-size:.85rem}.message-card__date[_ngcontent-%COMP%]{color:var(--text-muted);font-size:.75rem;white-space:nowrap}.message-card__body[_ngcontent-%COMP%]{color:var(--text-secondary);font-size:.9rem}.message-card__actions[_ngcontent-%COMP%]{display:flex;gap:.6rem;flex-wrap:wrap}"]})}}return r})();export{Q as ContactsAdminComponent};
