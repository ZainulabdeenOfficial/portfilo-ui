import{d as p}from"./chunk-SSKLMT2D.js";import{Ha as l,Mb as m,O as c,Pb as f,T as n,m as s,q as a,tb as u,y as h}from"./chunk-V5WJDX62.js";var x=(()=>{class i{constructor(t,e){this.http=t,this.router=e,this.baseUrl=f.apiBaseUrl,this.TOKEN_KEY="portfolio_jwt_token",this.tokenInMemory=null,this._isAuthenticated=l(!1),this.isAuthenticated=u(()=>this._isAuthenticated()),this.loadFromStorage()}login(t){return this.http.post(`${this.baseUrl}/Auth/login`,t,{observe:"response"}).pipe(a(e=>{let r=e.body,k=(e.headers.get("Authorization")||e.headers.get("authorization"))?.replace(/^Bearer\s+/i,""),o=this.extractToken(r)||k;if(!o)return null;let g=r?.expiration||r?.expires||r?.data?.expiration||"";return this.setToken(o),{token:o,expiration:g}}),h(()=>s(null)))}extractToken(t){return t?typeof t=="string"?t:t.token||t.accessToken||t.access_token||t.jwt||t.result||t.data?.token||t.data?.accessToken||t.data?.access_token||t.data?.jwt||null:null}logout(){this.tokenInMemory=null,localStorage.removeItem(this.TOKEN_KEY),this._isAuthenticated.set(!1),this.router.navigate(["/admin/login"])}getToken(){return this.tokenInMemory||localStorage.getItem(this.TOKEN_KEY)}setToken(t){this.tokenInMemory=t,localStorage.setItem(this.TOKEN_KEY,t),this._isAuthenticated.set(!0)}loadFromStorage(){let t=localStorage.getItem(this.TOKEN_KEY);t&&(this.tokenInMemory=t,this._isAuthenticated.set(!0))}static{this.\u0275fac=function(e){return new(e||i)(n(m),n(p))}}static{this.\u0275prov=c({token:i,factory:i.\u0275fac,providedIn:"root"})}}return i})();export{x as a};
